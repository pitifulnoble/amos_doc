# 查询缓存

## 查询缓存的一些规则
1. 缓存的结果是所有sessions 共享的
2. 缓存key是SQL的Hash值，只有SQL完全一致才会命中
3. 不缓存子查询结果集，仅缓存查询最终结果集
4. 不确定的函数不会被缓存
5. 不缓存产生告警（Warnings）的查询
6. />query_cache_limit（单位byte）大小的查询不会被缓存包含用户自定义函数，存储函数，用户变量，临时表，系统表的查询不缓存

7. 包含用户自定义函数，存储函数.用户变量，临时表，系统表的查询不缓存
8. 一旦有数据发生变化，这张表相关的所有缓存数据都会失效
9. 使用 SQL_NO_CACHE 的查询语句不会缓存
10. 数据表使用了分区，Query Cache将会被自动的禁用
11. MyISAM缓存在OS Cache中，InnoDB则放在Buffer Pool中



## mysql8.0之后废弃查询缓存的原因
1. 查询缓存的命中率不高（命中缓存过于苛刻）
2. 查询缓存容易失效（一个数据行的变更就会造成大量缓存数据的实效）
3. 影响MYSQL服务的性能
4. 查询缓存会导致性能上的不可预测性
5. 业务中的缓存技术已经相当成熟。比如Redis，和业务逻辑强绑定