# 数据库事务

事务的四大特性:<br>
ACID（Atomicity、Consistency、Isolation、Durability，即原子性、一致性、隔离性、持久性）

## 1.隔离性

- 1.问题:脏读（dirty read）、不可重复读（non-repeatable read）、幻读（phantom read）
    - 1.1.脏读：一个事务读到另一个事务未提交的数据
    - 1.2.不可重复读：因另一个事务更新数据，当前事务多次读取相同数据时，值不同
    - 1.3.
- 2.级别:读未提交（read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（serializable ）
    - 2.1.读未提交是指，一个事务还没提交时，它做的变更就能被别的事务看到。
    - 2.2.读提交是指，一个事务提交之后，它做的变更才会被其他事务看到。
    - 2.3.可重复读是指，一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的。
    - 2.4.串行化，顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。

## 2.可重复读的实现
为了实现``可重复读``引入了视图的概念.在每次启动一个事务时,就创建一个视图.在这个视图下不会读取其他事务提交的数据,该事务也不会影响其他事务.<br>
所以数据库中会保存很多的副本,所以不建议长事务逻辑出现在代码中.详见[https://time.geekbang.org/column/article/68963](https://time.geekbang.org/column/article/68963)<br>

## 3.一些最佳实践
不要再开发中使用长事务，检查不要让开发框架设置``set autocommit=0``，使用显示事务。<br>